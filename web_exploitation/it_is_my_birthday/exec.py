#!/usr/bin/python3

import re
import requests

def main():
  url ="http://mercury.picoctf.net:55343/index.php"
  with open('collision1.pdf', 'rb') as file1, open('collision2.pdf', 'rb') as file2:
    files = {
      "file1": ("collision1.pdf", file1, "application/pdf"),
      "file2": ("collision2.pdf", file2, "application/pdf")
    }

    data = {
      "submit": "Upload"
    }

    headers = {
      "Cache-Control": "max-age=0"
    }

    res = requests.post(url, headers=headers, files=files, data=data)
    result = re.findall("picoCTF{.*?}", res.text)
    if result:
      print(result[0])
    

if __name__ == '__main__':
  main()
